<!DOCTYPE html>
<html>
  <head>
    {% load static %}
    <link rel="stylesheet" href="{% static 'polls/styles.css' %}">
  </head>
  <body>
    <div class="container">
      <div class="toppane">
        <b>Time Delay Attack Detection and Characterization</b>
      </div>
      <div class="leftpane">
        <form action="/polls/" method="post"  enctype="multipart/form-data">
          {% if protection %}
            <input type="submit" name="goback" value="Go Back">
          {% endif %}
          <b>{% csrf_token %}
          {{ form.as_p }}</b>
          <input type="submit" name="apply" value="Apply">
        </form>
      </div>

      <div class="centerpane">
        <!-- <center> -->
        <!-- {% load static %} -->
          {% if protection %}
            <img id="signal" src="{% static 'polls/signal1.png' %}" alt="Original Signal" width="100%"/>
            <br>
            <!-- <br> -->
            <img id="classification" src="{% static 'polls/classification1.png' %}" alt="Classification Output" width="100%"/>
            <!-- <br> -->
            <br>
            <img id="regression" src="{% static 'polls/regression1.png' %}" alt="Regression Output" width="100%"/>
          {% endif %}
        <!-- </center> -->
      </div>
      <div class='rightpane'>
        <br>
        {% if ppcs %}
          <h3>Power Plant Control System</h3>
          <img src="{% static 'polls/ppcs.png' %}" alt="PPCS System" width="80%"/>
        {% else %}
          <h3>Automatic Generation Control</h3>
          <img src="{% static 'polls/agc.png' %}" alt="AGC System" width="80%"/>
        {% endif %}

        <br>
        <br>
        {% if protection %}
          {% if update_done %}
            <p style="color:darkred"><b>Attack launched at : {{ attack_loc }} sec</b>
            <br> <b>Attack value : {{ attack_value }} sec</b></p>
            <p style="color:blue"><b>Attack detected at : {{ detection_loc }} sec</b></p>
            <p style="color:green"><b>Attack characterized at : {{ prediction_loc }} sec</b>
            <br> <b>Predicted attack value : {{ prediction_value }} sec</b></p>
          {% endif %}
        {% endif %}
      </div>
      <!-- <div style="clear:both; font-size:1px;"></div> -->
    </div>
    <script>
        function sleep(ms) {
          return new Promise(resolve => setTimeout(resolve, ms));
        }
        document.addEventListener('DOMContentLoaded', function() {
          GFG_Fun();
          }, false);
        var signal = document.getElementById('signal');
        var classification = document.getElementById('classification');
        var regression = document.getElementById('regression');
        var endnum = "{{endnum}}"
        async function GFG_Fun() {
            var i;
            for (i = 1; i < endnum; i++) {
              await sleep(100);
              signal.src = "/static/polls/signal" + i + ".png";
              classification.src = "/static/polls/classification" + i + ".png";
              regression.src = "/static/polls/regression" + i + ".png";
            }
        }
    </script>
  </body>
</html>
